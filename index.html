<!DOCTYPE html>
<html lang="pt-PT">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Escala de Serviço - CBSLeiria</title>
    <link rel="icon" href="favicon.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Biblioteca para gerar imagem -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        
        .compact-input { height: 2rem; font-size: 0.95rem; }
        .num-input { width: 3.5rem; text-align: center; font-weight: 700; color: #475569; }
        .role-label { font-size: 0.7rem; font-weight: 700; text-transform: uppercase; color: #64748b; min-width: 80px; }
        
        input:focus { outline: none; border-color: #dc2626; z-index: 10; }
        .group-header { font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; padding: 0.25rem 0.5rem; }

        /* Estilos específicos para Impressão (PDF) */
        @media print {
            .no-print { display: none !important; }
            body { background-color: white; padding-bottom: 0; }
            input { border: none !important; background: transparent !important; padding-left: 0; }
            .shadow-sm, .shadow-lg { box-shadow: none !important; }
            .bg-slate-100 { background-color: white !important; }
            .bg-red-700 { background-color: #b91c1c !important; color: white !important; }
            .bg-yellow-400 { background-color: #facc15 !important; }
            .bg-slate-700 { background-color: #334155 !important; color: white !important; }
            .role-label { color: #000 !important; }
            main { transform: scale(0.95); transform-origin: top center; }
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen text-slate-800 pb-20">

    <!-- Wrapper principal para captura (Inclui Header e Main) -->
    <div id="export-container" class="bg-slate-100">
        
        <!-- Header -->
        <header class="bg-red-700 text-white shadow-sm sticky top-0 z-30 transition-transform">
            <div class="max-w-2xl mx-auto px-3 py-2 flex items-center justify-between gap-2">
                <!-- Título e Ícone -->
                <div class="flex items-center gap-2 flex-shrink-0">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-yellow-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                    </svg>
                    <h1 class="text-xs sm:text-sm font-bold uppercase tracking-wide leading-tight">Escala<br class="block sm:hidden"> Serviço</h1>
                </div>
                
                <!-- Data e Botões -->
                <div class="flex items-center gap-2">
                     <div id="date-display" class="text-[10px] sm:text-xs font-bold bg-red-800 px-2 py-1 rounded text-white border border-red-600 shadow-inner whitespace-nowrap"></div>
                     
                     <!-- Botões de Exportação -->
                     <div class="flex gap-1">
                        <button onclick="downloadImage()" class="no-print bg-white/20 hover:bg-white/30 text-white p-1.5 rounded transition-colors" title="Guardar como Imagem">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                        </button>
                        <button onclick="window.print()" class="no-print bg-white/20 hover:bg-white/30 text-white p-1.5 rounded transition-colors" title="Imprimir / PDF">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path></svg>
                        </button>
                     </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="max-w-2xl mx-auto px-2 py-2 space-y-2">

            <!-- 1. Chefe de Serviço -->
            <div class="bg-white rounded border-l-4 border-l-yellow-500 border border-slate-300 shadow-sm p-2">
                <div class="flex items-center gap-2">
                    <div class="w-8 flex justify-center"><svg class="w-5 h-5 text-yellow-500" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg></div>
                    <div class="flex-grow flex gap-1 relative">
                        <input type="number" id="chefe_servico_num" placeholder="Nº" class="num-input bg-yellow-50 border border-slate-300 rounded compact-input">
                        <input type="text" id="chefe_servico_nome" placeholder="Chefe de Serviço" class="flex-grow bg-yellow-50 border border-slate-300 rounded px-2 compact-input font-bold text-slate-900">
                        <button onclick="clearRow('chefe_servico')" class="no-print px-2 text-slate-300 hover:text-red-600 transition-colors"><svg class="h-5 w-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" /></svg></button>
                    </div>
                </div>
            </div>

            <!-- 2. CMOS Block -->
            <div class="bg-white rounded border border-slate-300 overflow-hidden shadow-sm">
                <div class="bg-slate-700 text-white group-header flex items-center justify-between">
                    <span>CMOS (Comunicações)</span>
                    <svg class="w-3 h-3 text-blue-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path></svg>
                </div>
                <div class="p-2 space-y-1.5">
                    <!-- Row -->
                    <div class="flex items-center gap-2">
                        <span class="role-label text-right">Chefe Equipa</span>
                        <div class="flex-grow flex gap-1">
                            <input type="number" id="chefe_cmos_num" placeholder="Nº" class="num-input bg-slate-50 border border-slate-200 rounded compact-input">
                            <input type="text" id="chefe_cmos_nome" class="flex-grow bg-slate-50 border border-slate-200 rounded px-2 compact-input">
                            <button onclick="clearRow('chefe_cmos')" class="no-print px-1 text-slate-300 hover:text-red-600"><svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button>
                        </div>
                    </div>
                    <!-- Row -->
                    <div class="flex items-center gap-2">
                        <span class="role-label text-right">Operador</span>
                        <div class="flex-grow flex gap-1">
                            <input type="number" id="operador_cmos_num" placeholder="Nº" class="num-input bg-slate-50 border border-slate-200 rounded compact-input">
                            <input type="text" id="operador_cmos_nome" class="flex-grow bg-slate-50 border border-slate-200 rounded px-2 compact-input">
                            <button onclick="clearRow('operador_cmos')" class="no-print px-1 text-slate-300 hover:text-red-600"><svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 3. INEM Block -->
            <div class="bg-white rounded border border-yellow-400 overflow-hidden shadow-sm">
                <div class="bg-yellow-400 text-blue-900 group-header flex items-center justify-between">
                    <span>INEM</span>
                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
                </div>
                <div class="p-2 space-y-1.5">
                    <!-- Row -->
                    <div class="flex items-center gap-2">
                        <span class="role-label text-right text-blue-900">Socorrista</span>
                        <div class="flex-grow flex gap-1">
                            <input type="number" id="inem_soc_num" placeholder="Nº" class="num-input bg-yellow-50 border border-yellow-200 rounded compact-input">
                            <input type="text" id="inem_soc_nome" class="flex-grow bg-yellow-50 border border-yellow-200 rounded px-2 compact-input">
                            <button onclick="clearRow('inem_soc')" class="no-print px-1 text-slate-300 hover:text-red-600"><svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button>
                        </div>
                    </div>
                    <!-- Row -->
                    <div class="flex items-center gap-2">
                        <span class="role-label text-right text-blue-900">Motorista</span>
                        <div class="flex-grow flex gap-1">
                            <input type="number" id="inem_mot_num" placeholder="Nº" class="num-input bg-yellow-50 border border-yellow-200 rounded compact-input">
                            <input type="text" id="inem_mot_nome" class="flex-grow bg-yellow-50 border border-yellow-200 rounded px-2 compact-input">
                            <button onclick="clearRow('inem_mot')" class="no-print px-1 text-slate-300 hover:text-red-600"><svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 4. Equipa 1 -->
            <div class="bg-white rounded border border-slate-300 overflow-hidden shadow-sm">
                <div class="bg-red-50 text-red-800 border-b border-red-100 group-header flex items-center justify-between">
                    <span>1.ª Equipa</span>
                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                </div>
                <div class="p-2 space-y-1.5">
                    <!-- Chefe -->
                    <div class="flex items-center gap-2">
                        <span class="role-label text-right text-red-700">Chefe Equipa</span>
                        <div class="flex-grow flex gap-1">
                            <input type="number" id="eq1_chefe_num" placeholder="Nº" class="num-input bg-red-50 border border-red-100 rounded compact-input">
                            <input type="text" id="eq1_chefe_nome" class="flex-grow bg-red-50 border border-red-100 rounded px-2 compact-input font-semibold">
                            <button onclick="clearRow('eq1_chefe')" class="no-print px-1 text-slate-300 hover:text-red-600"><svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button>
                        </div>
                    </div>
                    <!-- B1 -->
                    <div class="flex items-center gap-2">
                        <span class="role-label text-right">Bombeiro 1</span>
                        <div class="flex-grow flex gap-1">
                            <input type="number" id="eq1_b1_num" placeholder="Nº" class="num-input bg-slate-50 border border-slate-200 rounded compact-input">
                            <input type="text" id="eq1_b1_nome" class="flex-grow bg-slate-50 border border-slate-200 rounded px-2 compact-input">
                            <button onclick="clearRow('eq1_b1')" class="no-print px-1 text-slate-300 hover:text-red-600"><svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button>
                        </div>
                    </div>
                    <!-- B2 -->
                    <div class="flex items-center gap-2">
                        <span class="role-label text-right">Bombeiro 2</span>
                        <div class="flex-grow flex gap-1">
                            <input type="number" id="eq1_b2_num" placeholder="Nº" class="num-input bg-slate-50 border border-slate-200 rounded compact-input">
                            <input type="text" id="eq1_b2_nome" class="flex-grow bg-slate-50 border border-slate-200 rounded px-2 compact-input">
                            <button onclick="clearRow('eq1_b2')" class="no-print px-1 text-slate-300 hover:text-red-600"><svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button>
                        </div>
                    </div>
                    <!-- B3 -->
                    <div class="flex items-center gap-2">
                        <span class="role-label text-right">Bombeiro 3</span>
                        <div class="flex-grow flex gap-1">
                            <input type="number" id="eq1_b3_num" placeholder="Nº" class="num-input bg-slate-50 border border-slate-200 rounded compact-input">
                            <input type="text" id="eq1_b3_nome" class="flex-grow bg-slate-50 border border-slate-200 rounded px-2 compact-input">
                            <button onclick="clearRow('eq1_b3')" class="no-print px-1 text-slate-300 hover:text-red-600"><svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button>
                        </div>
                    </div>
                     <!-- Mot 1 -->
                    <div class="flex items-center gap-2">
                        <span class="role-label text-right text-slate-600">Motorista 1</span>
                        <div class="flex-grow flex gap-1">
                            <input type="number" id="eq1_mot_num" placeholder="Nº" class="num-input bg-slate-100 border border-slate-300 rounded compact-input">
                            <input type="text" id="eq1_mot_nome" class="flex-grow bg-slate-100 border border-slate-300 rounded px-2 compact-input font-medium">
                            <button onclick="clearRow('eq1_mot')" class="no-print px-1 text-slate-300 hover:text-red-600"><svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 5. Equipa 2 -->
            <div class="bg-white rounded border border-slate-300 overflow-hidden shadow-sm">
                <div class="bg-slate-100 text-slate-600 border-b border-slate-200 group-header flex items-center justify-between">
                    <span>2.ª Equipa</span>
                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                </div>
                <div class="p-2 space-y-1.5">
                    <!-- B4 -->
                    <div class="flex items-center gap-2">
                        <span class="role-label text-right">Bombeiro 4</span>
                        <div class="flex-grow flex gap-1">
                            <input type="number" id="eq2_b4_num" placeholder="Nº" class="num-input bg-slate-50 border border-slate-200 rounded compact-input">
                            <input type="text" id="eq2_b4_nome" class="flex-grow bg-slate-50 border border-slate-200 rounded px-2 compact-input">
                            <button onclick="clearRow('eq2_b4')" class="no-print px-1 text-slate-300 hover:text-red-600"><svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button>
                        </div>
                    </div>
                    <!-- B5 -->
                    <div class="flex items-center gap-2">
                        <span class="role-label text-right">Bombeiro 5</span>
                        <div class="flex-grow flex gap-1">
                            <input type="number" id="eq2_b5_num" placeholder="Nº" class="num-input bg-slate-50 border border-slate-200 rounded compact-input">
                            <input type="text" id="eq2_b5_nome" class="flex-grow bg-slate-50 border border-slate-200 rounded px-2 compact-input">
                            <button onclick="clearRow('eq2_b5')" class="no-print px-1 text-slate-300 hover:text-red-600"><svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button>
                        </div>
                    </div>
                     <!-- Mot 2 -->
                    <div class="flex items-center gap-2">
                        <span class="role-label text-right text-slate-600">Motorista 2</span>
                        <div class="flex-grow flex gap-1">
                            <input type="number" id="eq2_mot_num" placeholder="Nº" class="num-input bg-slate-100 border border-slate-300 rounded compact-input">
                            <input type="text" id="eq2_mot_nome" class="flex-grow bg-slate-100 border border-slate-300 rounded px-2 compact-input font-medium">
                            <button onclick="clearRow('eq2_mot')" class="no-print px-1 text-slate-300 hover:text-red-600"><svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Extra Notes Field -->
            <div class="bg-white rounded border border-slate-200 p-2 shadow-sm">
                <textarea id="obs_gerais" placeholder="Observações / Reforços..." class="w-full text-xs text-slate-600 border-0 bg-transparent resize-none focus:ring-0 p-1" rows="2"></textarea>
            </div>
<div class="text-center text-[10px] text-slate-600 mt-4 px-4">
            Mesmo fechando o browser, os nomes permanecem na escala quando este for reaberto. <br>
            Só será tudo eliminado quando selecionar "LIMPAR ESCALA" <br>
        </div>

        </main>
    </div> <!-- Fim do Wrapper de Exportação -->

    <!-- Footer Controls (Fixed) -->
    <div class="fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 p-2 shadow-lg z-30 no-print">
        <div class="max-w-2xl mx-auto flex justify-center">
            <button onclick="openModal()" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded shadow transition-all active:scale-95 flex items-center justify-center gap-2 text-sm uppercase">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                Limpar Escala
            </button>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="fixed inset-0 bg-gray-900 bg-opacity-60 hidden flex items-center justify-center z-50 p-4 opacity-0 transition-opacity duration-300 backdrop-blur-sm no-print">
        <div class="bg-white rounded shadow-2xl max-w-xs w-full p-4 transform scale-95 transition-transform duration-300 border-2 border-red-500" id="modalContent">
            <div class="text-center mb-4">
                 <div class="mx-auto flex items-center justify-center h-10 w-10 rounded-full bg-red-100 mb-2">
                    <svg class="h-6 w-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                </div>
                <h3 class="text-base font-bold text-gray-900 uppercase">Eliminar tudo?</h3>
                <p class="text-xs text-gray-500">Esta ação não pode ser desfeita.</p>
            </div>
            <div class="flex gap-2">
                <button onclick="closeModal()" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-2 rounded text-xs transition-colors">CANCELAR</button>
                <button onclick="clearAllData()" class="flex-1 bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-2 rounded text-xs transition-colors">ELIMINAR</button>
            </div>
        </div>
    </div>

    <script>
        // Prefix list of all roles
        const rolePrefixes = [
            'chefe_servico', 
            'chefe_cmos', 'operador_cmos',
            'inem_soc', 'inem_mot', 
            'eq1_chefe', 'eq1_b1', 'eq1_b2', 'eq1_b3', 'eq1_mot',
            'eq2_b4', 'eq2_b5', 'eq2_mot'
        ];

        window.onload = function() {
            // Restore both Num and Nome for each role
            rolePrefixes.forEach(prefix => {
                restoreInput(prefix + '_num');
                restoreInput(prefix + '_nome');
            });
            // Restore Obs
            const obs = document.getElementById('obs_gerais');
            if(obs) {
                const saved = localStorage.getItem('bombeiros_app_v4_obs');
                if(saved) obs.value = saved;
                obs.addEventListener('input', (e) => localStorage.setItem('bombeiros_app_v4_obs', e.target.value));
            }

            // Set Date
            const dateOptions = { weekday: 'long', day: 'numeric', month: 'long' };
            const today = new Date().toLocaleDateString('pt-PT', dateOptions);
            document.getElementById('date-display').textContent = today.toUpperCase();
        };

        function restoreInput(id) {
            const el = document.getElementById(id);
            if(!el) return;
            
            const savedValue = localStorage.getItem('bombeiros_app_v4_' + id);
            if (savedValue) {
                el.value = savedValue;
            }
            
            el.addEventListener('input', function(e) {
                localStorage.setItem('bombeiros_app_v4_' + id, e.target.value);
            });
        }

        // Clear both Number and Name for a specific row
        function clearRow(prefix) {
            const numId = prefix + '_num';
            const nomeId = prefix + '_nome';
            
            const elNum = document.getElementById(numId);
            const elNome = document.getElementById(nomeId);
            
            if(elNum) {
                elNum.value = '';
                localStorage.removeItem('bombeiros_app_v4_' + numId);
            }
            if(elNome) {
                elNome.value = '';
                localStorage.removeItem('bombeiros_app_v4_' + nomeId);
                elNome.focus();
            }
        }

        // Image Download Function
        function downloadImage() {
            // Find buttons to hide manually
            const noPrintElements = document.querySelectorAll('.no-print');
            noPrintElements.forEach(el => el.style.visibility = 'hidden');

            // Handle Header Stickness for capture
            const header = document.querySelector('header');
            header.classList.remove('sticky', 'top-0');

            const captureElement = document.getElementById('export-container');

            html2canvas(captureElement, {
                scale: 2, 
                backgroundColor: '#f1f5f9' 
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'escala_servico_' + new Date().toISOString().split('T')[0] + '.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                // Restore visibility and sticky
                noPrintElements.forEach(el => el.style.visibility = 'visible');
                header.classList.add('sticky', 'top-0');
            });
        }

        function openModal() {
            const modal = document.getElementById('confirmModal');
            const content = document.getElementById('modalContent');
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.remove('opacity-0');
                content.classList.remove('scale-95');
                content.classList.add('scale-100');
            }, 10);
        }

        function closeModal() {
            const modal = document.getElementById('confirmModal');
            const content = document.getElementById('modalContent');
            
            modal.classList.add('opacity-0');
            content.classList.remove('scale-100');
            content.classList.add('scale-95');
            
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }

        function clearAllData() {
            rolePrefixes.forEach(prefix => {
                // Clear DOM
                const elNum = document.getElementById(prefix + '_num');
                const elNome = document.getElementById(prefix + '_nome');
                if(elNum) elNum.value = '';
                if(elNome) elNome.value = '';
                
                // Clear Storage
                localStorage.removeItem('bombeiros_app_v4_' + prefix + '_num');
                localStorage.removeItem('bombeiros_app_v4_' + prefix + '_nome');
            });
            // Clear obs
            document.getElementById('obs_gerais').value = '';
            localStorage.removeItem('bombeiros_app_v4_obs');
            
            closeModal();
        }
    </script>
</body>
</html>